<!DOCTYPE html>
<html>

<head>
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons|Carter+One|Heebo" rel="stylesheet">
  <!--Personal Style Sheet-->
  <link rel="stylesheet" href="./assets/css/reset.css">
  <link rel="stylesheet" href="./assets/css/style.css">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <!--jQuery-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- FireBase -->
  <script src="https://www.gstatic.com/firebasejs/5.9.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.3/firebase-auth.js"></script>
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
</head>

<body>
  <!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>Attention!</h4>
      <p>You must enter both a username and password to continue.</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Okay</a>
    </div>
  </div>

  <div id="modal2" class="modal">
    <div class="modal-content">
      <h4>Attention!</h4>
      <p>This account does not exist. Create an account using this information?</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">No</a>
      <a href="#!" class="modal-close waves-effect waves-green btn-flat" id="create-login">Yes</a>
    </div>
  </div>

  <div class="header-display">
   <span><i class="fas fa-dice-d20 dice"></i></span>
    <h1 class="title">D&D Spells</h1>
  </div>
  <div class="container">
    <div class="row main-content">
      <div class="col 12">
        <div class="card">
          <div class="row">
            <div class="col s12">
              <div class="card-content">
                <div class="row">
                  <form class="col s12">
                    <div class="img">
                      <img class="welcome-img" src="./assets/images/imgplaceholder.png" alt="" class="src">
                    </div>
                    <div class="row">
                      <div class="input-field col s12">
                        <textarea id="username" class="materialize-textarea"></textarea>
                        <label for="textarea1">Login</label>
                      </div>
                      <div class="input-field col s12">
                        <input id="password" type="password" class="materialize-textarea" type="password"></textarea>
                        <label for="textarea1">Password</label>
                      </div>
                    </div>
                  </form>
                  <a class="waves-effect waves-light btn-small">Login</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    var elem1 = document.querySelector('#modal1');
    var elem2 = document.querySelector('#modal2');
    var config = {
    apiKey: "AIzaSyAULV8HQ9A5Uzh1V6BdGT9O9hLBuuuvObo",
    authDomain: "dnd-spells-ec615.firebaseapp.com",
    databaseURL: "https://dnd-spells-ec615.firebaseio.com",
    projectId: "dnd-spells-ec615",
    storageBucket: "dnd-spells-ec615.appspot.com",
    messagingSenderId: "968367721001"
  };
  firebase.initializeApp(config);

  firebase.auth().signOut().then(function() {
  // Run code to get back to the login screen
}).catch(function(error) {
  // An error happened.
});

    $(".btn-small").on('click', function () {
      var username = $("#username").val().trim();
      var password = $("#password").val().trim();
      if (username === "" || password === "") {
        var instance = M.Modal.init(elem1);
        instance.open();
      }
      else {
        firebase.auth().signInWithEmailAndPassword(username, password).then(function() {
          window.location.href = "./pages/main.html";
        }).catch(function(error) {
        var errorCode = error.code;
        var errorMessage = error.message;
        // Handle Errors here, such as invalid login info
          var instance = M.Modal.init(elem2);
          instance.open();
        });
      }
    });

    $("#create-login").on('click', function () {
      var username = $("#username").val().trim();
      var password = $("#password").val().trim();

      firebase.auth().createUserWithEmailAndPassword(username, password).catch(function(error) {
        var errorCode = error.code;
        var errorMessage = error.message;
        // Handle Errors here
        console.log(errorMessage);
      });
    });

  </script>


  <!--JavaScript at end of body for optimized loading-->

</body>

</html>